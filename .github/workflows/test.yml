
name: Test

on:
#  workflow_run:
#    workflows: [CI-Start]
#    types:
#      - completed

# Temp - will GitHub pickthis up?
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest

    if: >
      ${{ (github.event.workflow_run.event == 'pull_request'
      || github.event.workflow_run.event == 'push')
      && github.event.workflow_run.conclusion == 'success' }}
    steps:
    - uses: actions/checkout@v2
    - name: Run Gradle command
      uses: Raul6469/android-gradle-action@2.0.0
      env:
        GITHUB_ACTOR: ${{ secrets.GRADLE_GITHUB_ACTOR }}
        GITHUB_TOKEN: ${{ secrets.GRADLE_GITHUB_TOKEN }}
      with:
        # Here, `./gradlew test` will be run
        script: test